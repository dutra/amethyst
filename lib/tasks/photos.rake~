require 'csv'

namespace :db do
  desc "Fill database with albums and photos"
  task photos: :environment do
    create_albums
    create_photos

  end
end



def create_photos


  CSV.foreach("db/data/photos.csv", headers: true) do | row |
    file = row['file']
    album = row['album']
    title = row['title']
    description = 

    end





  blizzard = Dir.glob(File.join(Rails.root, 'private', 'albums', 'blizzard', '*')).sort
  blizzard.each do |file|
    puts file
    p = Album.find_by_title("Blizzard").photos.new
    p.file = File.open(file)
    p.title = "Blizzard"
    p.save!

  end
  cover = Album.find_by_title("Blizzard").photos.find(13)
  cover.album_cover_id = Album.find_by_title("Blizzard").id
  cover.save!


  p = Album.find(2).photos.new
  p.file = File.open(Dir.glob(File.join(Rails.root, 'private', 'sample_images', 'dinner1.jpg')).first)
  p.title = "Dinner 1"
  p.album_cover_id = 2
  p.save!

  p = Album.find(2).photos.new
  p.file = File.open(Dir.glob(File.join(Rails.root, 'private', 'sample_images', 'dinner2.jpg')).first)
  p.title = "Dinner 2"
  p.save!

  p = Album.find(3).photos.new
  p.file = File.open(Dir.glob(File.join(Rails.root, 'private', 'sample_images', 'party.jpg')).first)
  p.title = "Parallel Universe"
  p.album_cover_id = 3
  p.save!




end
